{"version":3,"file":"topic-nav.js","sources":["pages/topic-nav/topic-nav.vue","../../AppGallery/HBuilderX.4.75.2025070414-alpha/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdG9waWMtbmF2L3RvcGljLW5hdi52dWU"],"sourcesContent":["<template>\r\n\t<view>\r\n\t\t<!-- 顶部选项卡 -->\r\n\t\t<scroll-view scroll-x :scroll-into-view=\"scrollInto\" \r\n\t\tscroll-with-animation class=\"scroll-row\" style=\"height: 100rpx;\">\r\n\t\t\t<view v-for=\"(item,index) in tabBars\" :key=\"index\" \r\n\t\t\tclass=\"scroll-row-item px-3 py-2\" :id=\"'tab'+index\"\r\n\t\t\t:class=\"tabIndex === index?'color-global font-lg font-weight-bold':''\"\r\n\t\t\t@click=\"changeTab(index)\">{{item.classname}}</view>\r\n\t\t</scroll-view>\r\n\t\t\r\n\t\t<!-- 滑动列表 -->\r\n\t\t<swiper :duration=\"150\" :current=\"tabIndex\" @change=\"onChangeTab\" :style=\"'height:'+scrollH+'px;'\">\r\n\t\t\t<swiper-item v-for=\"(item,index) in newList\" :key=\"index\">\r\n\t\t\t\t<scroll-view scroll-y=\"true\" :style=\"'height:'+scrollH+'px;'\" @scrolltolower=\"loadmore(index)\">\r\n\t\t\t\t\t<template v-if=\"item.list.length > 0\">\r\n\t\t\t\t\t<!-- 列表 -->\r\n\t\t\t\t\t<block v-for=\"(item2,index2) in item.list\" :key=\"index2\">\r\n\t\t\t\t\t\t<!-- 列表样式 -->\t\t\t\t\t\t\r\n\t\t\t\t\t\t<topic-list :choose=\"choose\" :item=\"item2\" :index=\"index2\"></topic-list>\r\n\t\t\t\t\t\t<!-- 全局分割线 -->\r\n\t\t\t\t\t\t<view class=\"divider\"></view>\r\n\t\t\t\t\t</block>\r\n\t\t\t\t\t<!-- 上拉加载 -->\r\n\t\t\t\t\t<load-more :loadmore=\"item.loadmore\"></load-more>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t\t<!-- 加载中 -->\r\n\t\t\t\t\t<template v-else-if=\"!item.firstLoad\">\r\n\t\t\t\t\t\t<view class=\"text-light-muted flex align-center justify-center font-md\"\r\n\t\t\t\t\t\tstyle=\"height: 200rpx;\">加载中</view>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t\t<!-- 没有数据 -->\r\n\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t<no-thing></no-thing>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</swiper-item>\r\n\t\t</swiper>\r\n\t\t\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\t\r\n\timport topicList from '@/components/find/topic-list.vue';\r\n\timport loadMore from '@/components/common/load-more.vue';\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\ttopicList ,\r\n\t\t\tloadMore\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t//列表高度\r\n\t\t\t\tscrollH : 600,\r\n\t\t\t\t// 顶部选项卡\r\n\t\t\t\tscrollInto : \"\",\r\n\t\t\t\ttabIndex : 0,\r\n\t\t\t\ttabBars: [],\r\n\t\t\t\tnewList:[],\r\n\t\t\t\tchoose:false\r\n\t\t\t}\r\n\t\t},\r\n\t\t//监听点击导航栏搜索框\r\n\t\tonNavigationBarSearchInputClicked() {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl:\"/pages/search/search?type=post\",\r\n\t\t\t})\r\n\t\t},\r\n\t\t//监听导航按钮点击事件\r\n\t\tonNavigationBarButtonTap() {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl:'/pages/add-input/add-input',\r\n\t\t\t})\r\n\t\t},\r\n\t\tonLoad(e) {\r\n\t\t\tuni.getSystemInfo({\r\n\t\t\t\tsuccess:res=>{\r\n\t\t\t\t\tthis.scrollH = res.windowHeight - uni.upx2px(100)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.getData()\r\n\t\t\t\r\n\t\t\tif(e.choose){\r\n\t\t\t\tuni.setNavigationBarTitle({\r\n\t\t\t\t\ttitle:'选择话题'\r\n\t\t\t\t})\r\n\t\t\t\tthis.choose = true\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t//获取数据\r\n\t\t\tgetData() {\r\n\t\t\t\t// 获取分类\r\n\t\t\t\tthis.$H.get('/postclass').then(res=>{\r\n\t\t\t\t\t// 渲染分类\r\n\t\t\t\t\tthis.tabBars = res.data.data.list\r\n\t\t\t\t\tvar arr = []\r\n\t\t\t\t\tfor (let i = 0; i < this.tabBars.length; i++) {\r\n\t\t\t\t\t\t//生成列表模板\r\n\t\t\t\t\t\tlet obj = {\r\n\t\t\t\t\t\t\t//1.上拉加载更多 2.加载中 3...没有更多了\r\n\t\t\t\t\t\t\tloadmore:\"上拉加载更多\",\r\n\t\t\t\t\t\t\tlist:[],\r\n\t\t\t\t\t\t\tpage:1,\r\n\t\t\t\t\t\t\tfirstLoad:false\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tarr.push(obj)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.newList = arr\r\n\t\t\t\t\t// 获取第一个分类的数据\r\n\t\t\t\t\tif (this.tabBars.length) {\r\n\t\t\t\t\t\tthis.getList()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 获取指定分类下的列表数据\r\n\t\t\tgetList(){\r\n\t\t\t\tlet index = this.tabIndex\r\n\t\t\t\tlet id = this.tabBars[index].id\r\n\t\t\t\tlet page = this.newList[index].page\r\n\t\t\t\tlet isrefresh = page === 1\r\n\t\t\t\tthis.$H.get('/topicclass/'+id+'/topic/'+page).then(res2=>{\r\n\t\t\t\t\tlet list = res2.data.data.list.map(item=>{\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tid:item.id,\r\n\t\t\t\t\t\t\tcover:item.titlepic,\r\n\t\t\t\t\t\t\ttitle:item.title,\r\n\t\t\t\t\t\t\tdesc:item.desc,\r\n\t\t\t\t\t\t\ttoday_count:item.today_count,\r\n\t\t\t\t\t\t\tnews_count:item.post_count\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.newList[index].list = isrefresh ? list : [...this.newList[index].list,\r\n\t\t\t\t\t...list],\r\n\t\t\t\t\tthis.newList[index].loadmore = list.length < 10 ?'没有更多了' : '上拉加载更多'\r\n\t\t\t\t\tif (isrefresh) {\r\n\t\t\t\t\t\tthis.newList[index].firstLoad = true\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(err=>{\r\n\t\t\t\t\tif (!isrefresh) {\r\n\t\t\t\t\t\tthis.newList[index].page--\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//监听滑动\r\n\t\t\tonChangeTab(e) {\r\n\t\t\t\tthis.changeTab(e.detail.current)\r\n\t\t\t},\r\n\t\t\t//切换选项卡\r\n\t\t\tchangeTab(index){\r\n\t\t\t\tif (this.tabIndex === index){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.tabIndex = index\r\n\t\t\t\t// 滚动到指定元素\r\n\t\t\t\tthis.scrollInto = 'tab'+index\r\n\t\t\t\t// 获取当前分类下的列表数据\r\n\t\t\t\tif (!this.newList[this.tabIndex].firstLoad) {\r\n\t\t\t\t\tthis.getList()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//上拉加载更多\r\n\t\t\tloadmore(index) {\r\n\t\t\t\t// 拿到当前列表\r\n\t\t\t\tlet item = this.newList[index]\r\n\t\t\t\t// 判断是否处于可加载状态\r\n\t\t\t\tif(item.loadmore !== '上拉加载更多') return;\r\n\t\t\t\t//修改当前列表加载状态\r\n\t\t\t\titem.loadmore = '加载中...'\r\n\t\t\t\t// 请求数据\r\n\t\t\t\titem.page++;\r\n\t\t\t\tthis.getList()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t\r\n</style>\n","import MiniProgramPage from 'F:/project/社区交友/pages/topic-nav/topic-nav.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}