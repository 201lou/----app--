{"version":3,"file":"login.js","sources":["pages/login/login.vue","../../AppGallery/HBuilderX.4.75.2025070414-alpha/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\n\t<view>\r\n\t\t<uni-status-bar></uni-status-bar>\n\t\t<view class=\"iconfont icon-guanbi1 flex align-center justify-center font-lg\" \r\n\t\tstyle=\"width: 100rpx;height: 100rpx;\" hover-class=\"bg-light\" @click=\"back\"></view>\r\n\t\t\r\n\t\t<view class=\"text-center\" style=\"padding-top: 130rpx;padding-bottom: 70rpx; font-size: 55rpx;\"\r\n\t\t>{{status ? '手机验证码登录' : '账号密码登录'}}</view>\r\n\t\t\r\n\t\t<view class=\"px-2\">\r\n\t\t\t<template v-if=\"!status\">\r\n\t\t\t\t<view class=\"mb-2\">\r\n\t\t\t\t\t<input type=\"text\" v-model=\"username\" placeholder=\"昵称/手机号/邮箱\" class=\"border-bottom p-2\"/>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"mb-2 flex align-stretch\">\r\n\t\t\t\t\t<input type=\"text\" v-model=\"password\" placeholder=\"请输入密码\" class=\"border-bottom p-2 flex-1\"/>\r\n\t\t\t\t\t<view class=\"border-bottom flex align-center justify-center font text-muted\" style=\"width: 150rpx;\">忘记密码</view>\r\n\t\t\t\t</view>\r\n\t\t\t</template>\r\n\t\t\t<template v-else>\r\n\t\t\t\t<view class=\"mb-2 flex align-stretch\">\r\n\t\t\t\t\t<view class=\"border-bottom flex align-center justify-center font px-2\">+86</view>\r\n\t\t\t\t\t<input type=\"text\" v-model=\"phone\" placeholder=\"手机号\" class=\"border-bottom p-2 flex-1\"/>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"mb-2 flex align-stretch\">\r\n\t\t\t\t\t<input type=\"text\" v-model=\"pincode\" placeholder=\"请输入验证码\" class=\"border-bottom p-2 flex-1\"/>\r\n\t\t\t\t\t<view class=\"border-bottom flex align-center justify-center font-sm text-white\" \r\n\t\t\t\t\tstyle=\"width: 180rpx;\" :class=\"codeTime > 0 ?'bg-color-disabled':'bg-color'\"\r\n\t\t\t\t\t@click=\"getCode\">{{codeTime > 0 ? codeTime+'s':'获取验证码'}}</view>\r\n\t\t\t\t</view>\r\n\t\t\t</template>\r\n\t\t\t\r\n\t\t\t\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"py-2 px-3\">\r\n\t\t\t<button class=\" text-white\" style=\"border-radius: 50rpx;border: 0;\"type=\"primary\" \r\n\t\t\t:disabled=\"disabled\" :class=\"disabled ? 'bg-color-disabled':'bg-color'\"\r\n\t\t\t@click=\"submit\">登录</button>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"flex align-center justify-center pt-2 pb-4\">\r\n\t\t\t<view class=\"text-primary font-sm\" @click=\"changeStatus\">{{status ? '账号密码登录' : '验证码登录'}}</view>\r\n\t\t\t<text class=\"text-muted mx-2\">|</text>\r\n\t\t\t<view class=\"text-primary font-sm\">登录遇见问题</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"flex align-center justify-center\">\r\n\t\t\t<view style=\"height: 1rpx;background-color: #ddd;width: 100rpx;\"></view>\r\n\t\t\t<view class=\"mx-2 text-muted\">社交账号登录</view>\r\n\t\t\t<view style=\"height: 1rpx;background-color: #ddd;width: 100rpx;\"></view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 第三方登录 -->\r\n\t\t<other-login back></other-login>\r\n\t\t\r\n\t\t<view class=\"flex align-center justify-center text-muted\">\r\n\t\t\t注册即代表同意<text class=\"text-primary\">《xxx社区协议》</text>\r\n\t\t</view>\r\n\t\t\n\t</view>\n</template>\n\n<script>\r\n\timport otherLogin from '@/components/common/other-login.vue';\r\n\timport uniStatusBar from '@/components/uni-uni/uni-status-bar/uni-status-bar.vue';\n\texport default {\r\n\t\tcomponents:{\r\n\t\t\tuniStatusBar,\r\n\t\t\totherLogin\r\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tstatus:false,\r\n\t\t\t\tusername:\"\",\r\n\t\t\t\tpassword:\"\",\r\n\t\t\t\tphone:\"\",\r\n\t\t\t\tpincode:\"\",\r\n\t\t\t\tcodeTime:0\n\t\t\t}\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\t\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tdisabled() {\r\n\t\t\t\tif (this.status) {\r\n\t\t\t\t\t// 验证码登录模式：手机号和验证码都不能为空\r\n\t\t\t\t\treturn this.phone === '' || this.pincode === ''\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 密码登录模式：用户名和密码都不能为空\r\n\t\t\t\t\treturn this.username === '' || this.password === ''\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\n\t\tmethods: {\n\t\t\tback() {\r\n\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\tdelta:1\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 初始化表单\r\n\t\t\tinitForm() {\r\n\t\t\t\tthis.username=''\r\n\t\t\t\tthis.password=''\r\n\t\t\t\tthis.phone=''\r\n\t\t\t\tthis.pincode=''\r\n\t\t\t},\r\n\t\t\t// 切换登录方式\r\n\t\t\tchangeStatus() {\r\n\t\t\t\t// 初始化表单\r\n\t\t\t\tthis.initForm()\r\n\t\t\t\tthis.status = !this.status\r\n\t\t\t},\r\n\t\t\t// 获取验证码\r\n\t\t\tgetCode() {\r\n\t\t\t\t// 防止重复获取\r\n\t\t\t\tif(this.codeTime >0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// 验证手机号\r\n\t\t\t\tif(!this.validata()) return\r\n\t\t\t\t// 倒计时\r\n\t\t\t\tthis.codeTime = 60\r\n\t\t\t\tlet timer = setInterval(()=>{\r\n\t\t\t\t\tif(this.codeTime >= 1){\r\n\t\t\t\t\t\tthis.codeTime--\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\t\tthis.codeTime = 0\r\n\t\t\t\t\t\tclearInterval(timer)\r\n\t\t\t\t\t}\r\n\t\t\t\t},1000)\r\n\t\t\t},\r\n\t\t\t// 表单验证\r\n\t\t\tvalidata() {\r\n\t\t\t\tvar mpattern = /^1[3-9]\\d{9}$/;\r\n\t\t\t\tif(!mpattern.test(this.phone)) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle:'手机号格式不正确',\r\n\t\t\t\t\t\ticon:'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\treturn true\r\n\t\t\t},\r\n\t\t\t// 提交\r\n\t\t\tsubmit() {\r\n\t\t\t\t// 表单验证\r\n\t\t\t\tif(this.staus) {\r\n\t\t\t\t\tif(!this.validata()) return\r\n\t\t\t\t}\r\n\t\t\t\t// 提交后端\r\n\t\t\t\tthis.$H.post('/user/login',{\r\n\t\t\t\t\tusername:this.username,\r\n\t\t\t\t\tpassword:this.password\r\n\t\t\t\t}).then(res=>{\r\n\t\t\t\t\t// 修改vuex的state,持久化存储\r\n\t\t\t\t\tthis.$store.commit('login',res.data.data)\r\n\t\t\t\t\t// 开启socket\r\n\t\t\t\t\tthis.$store.dispatch('openSocket')\r\n\t\t\t\t\t// 提示和跳转\r\n\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\tdelta:1\r\n\t\t\t\t\t})\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle:'登录成功',\r\n\t\t\t\t\t\ticon:'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\n</style>\n","import MiniProgramPage from 'F:/project/社区交友/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAgEC,MAAK,aAAc,MAAW;AAC9B,MAAK,eAAgB,MAAW;AAChC,MAAK,YAAU;AAAA,EACd,YAAW;AAAA,IACV;AAAA,IACA;AAAA,EACA;AAAA,EACD,OAAO;AACN,WAAO;AAAA,MACN,QAAO;AAAA,MACP,UAAS;AAAA,MACT,UAAS;AAAA,MACT,OAAM;AAAA,MACN,SAAQ;AAAA,MACR,UAAS;AAAA,IACV;AAAA,EACA;AAAA,EACD,SAAS;AAAA,EAER;AAAA,EACD,UAAU;AAAA,IACT,WAAW;AACV,UAAI,KAAK,QAAQ;AAEhB,eAAO,KAAK,UAAU,MAAM,KAAK,YAAY;AAAA,aACvC;AAEN,eAAO,KAAK,aAAa,MAAM,KAAK,aAAa;AAAA,MAClD;AAAA,IACD;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,OAAO;AACNA,oBAAAA,MAAI,aAAa;AAAA,QAChB,OAAM;AAAA,MACP,CAAC;AAAA,IACD;AAAA;AAAA,IAED,WAAW;AACV,WAAK,WAAS;AACd,WAAK,WAAS;AACd,WAAK,QAAM;AACX,WAAK,UAAQ;AAAA,IACb;AAAA;AAAA,IAED,eAAe;AAEd,WAAK,SAAS;AACd,WAAK,SAAS,CAAC,KAAK;AAAA,IACpB;AAAA;AAAA,IAED,UAAU;AAET,UAAG,KAAK,WAAU,GAAG;AACpB;AAAA,MACD;AAEA,UAAG,CAAC,KAAK,SAAQ;AAAI;AAErB,WAAK,WAAW;AAChB,UAAI,QAAQ,YAAY,MAAI;AAC3B,YAAG,KAAK,YAAY,GAAE;AACrB,eAAK;AAAA,eACA;AACL,eAAK,WAAW;AAChB,wBAAc,KAAK;AAAA,QACpB;AAAA,MACA,GAAC,GAAI;AAAA,IACN;AAAA;AAAA,IAED,WAAW;AACV,UAAI,WAAW;AACf,UAAG,CAAC,SAAS,KAAK,KAAK,KAAK,GAAG;AAC9BA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAM;AAAA,UACN,MAAK;AAAA,QACN,CAAC;AACD,eAAO;AAAA,MACR;AACA,aAAO;AAAA,IACP;AAAA;AAAA,IAED,SAAS;AAER,UAAG,KAAK,OAAO;AACd,YAAG,CAAC,KAAK,SAAQ;AAAI;AAAA,MACtB;AAEA,WAAK,GAAG,KAAK,eAAc;AAAA,QAC1B,UAAS,KAAK;AAAA,QACd,UAAS,KAAK;AAAA,OACd,EAAE,KAAK,SAAK;AAEZ,aAAK,OAAO,OAAO,SAAQ,IAAI,KAAK,IAAI;AAExC,aAAK,OAAO,SAAS,YAAY;AAEjCA,sBAAAA,MAAI,aAAa;AAAA,UAChB,OAAM;AAAA,SACN;AACDA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAM;AAAA,UACN,MAAK;AAAA,SACL;AAAA,OACD;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1KD,GAAG,WAAW,eAAe;"}