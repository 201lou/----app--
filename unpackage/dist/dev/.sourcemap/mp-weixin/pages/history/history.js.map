{"version":3,"file":"history.js","sources":["pages/history/history.vue","../../AppGallery/HBuilderX.4.75.2025070414-alpha/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaGlzdG9yeS9oaXN0b3J5LnZ1ZQ"],"sourcesContent":["<template>\n\t<view>\n\t\t<common-list v-for=\"(item,index) in list\" :key=\"index\" :item=\"item\" :index=\"index\"></common-list>\r\n\t\t<no-thing v-if=\"list.length === 0\"></no-thing>\n\t</view>\n</template>\n\n<script>\r\n\timport commonList from '@/components/common/common-list.vue';\r\n\timport noThing from '@/components/common/no-thing.vue';\n\texport default {\r\n\t\tcomponents:{\r\n\t\t\tcommonList,\r\n\t\t\tnoThing\r\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tlist:[]\n\t\t\t}\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\t// 取出历史记录\r\n\t\t\tlet list = uni.getStorageSync('history')\r\n\t\t\tif(list){\r\n\t\t\t\tthis.list = JSON.parse(list)\r\n\t\t\t}\r\n\t\t\t// 监听关注和顶踩操作\r\n\t\t\tuni.$on('updateFollowOrLiked',(e)=>{\r\n\t\t\t\tswitch (e.type){\r\n\t\t\t\t\tcase 'follow'://关注\r\n\t\t\t\t\tthis.follow(e.data.user_id)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'liked':\r\n\t\t\t\t\tthis.liked(e.data)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t// 监听评论数变化\r\n\t\t\tuni.$on('updateCommentsCount',({id,count})=>{\r\n\t\t\t\tthis.list.forEach(item=>{\r\n\t\t\t\t\tif(item.id === id) {\r\n\t\t\t\t\t\titem.comment_count = count\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\tuni.$off('updateFollowOrLiked',(e)=>{})\r\n\t\t\tuni.$off('updateCommentsCount',(e)=>{})\r\n\t\t},\r\n\t\tonNavigationBarButtonTap() {\r\n\t\t\tuni.showModal({\r\n\t\t\t\tcontent:'是否要清除历史记录',\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tif(res.confirm){\r\n\t\t\t\t\t\tuni.removeStorageSync('history')\r\n\t\t\t\t\t\tthis.list = []\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\n\t\tmethods: {\n\t\t\t//关注\r\n\t\t\tfollow(user_id){\r\n\t\t\t\t// 找到当前作者的所有列表\r\n\t\t\t\tthis.list.forEach((item)=>{\r\n\t\t\t\t\tif(item.user_id === user_id){\r\n\t\t\t\t\t\titem.isFollow = true\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle:'关注成功',\r\n\t\t\t\t\ticon:'none'\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//顶踩\r\n\t\t\tliked(e){\r\n\t\t\t\tthis.list.forEach(item=>{\r\n\t\t\t\t\tif(item.id === e.id){\r\n\t\t\t\t\t\tif (item.liked.type === ''){\r\n\t\t\t\t\t\t\titem.liked[e.type+'_count']++\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (item.liked.type === 'liked' && e.type === 'disliked'){\r\n\t\t\t\t\t\t\titem.liked.liked_count--;\r\n\t\t\t\t\t\t\titem.liked.disliked_count++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(item.liked.type === 'disliked' && e.type === 'liked'){\r\n\t\t\t\t\t\t\titem.liked.liked_count++;\r\n\t\t\t\t\t\t\titem.liked.disliked_count--;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\titem.liked.type = e.type\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tlet msg = e.type === 'liked' ? '赞':'踩'\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle:msg+'成功',\r\n\t\t\t\t\ticon:'none'\r\n\t\t\t\t});\r\n\t\t\t},\n\t\t}\n\t}\n</script>\n\n<style>\n\n</style>\n","import MiniProgramPage from 'F:/project/社区交友/pages/history/history.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAQC,MAAK,aAAc,MAAW;AAC9B,gBAAgB,MAAW;AAC3B,MAAK,YAAU;AAAA,EACd,YAAW;AAAA,IACV;AAAA,IACA;AAAA,EACA;AAAA,EACD,OAAO;AACN,WAAO;AAAA,MACN,MAAK,CAAC;AAAA,IACP;AAAA,EACA;AAAA,EACD,SAAS;AAER,QAAI,OAAOA,cAAAA,MAAI,eAAe,SAAS;AACvC,QAAG,MAAK;AACP,WAAK,OAAO,KAAK,MAAM,IAAI;AAAA,IAC5B;AAEAA,kBAAAA,MAAI,IAAI,uBAAsB,CAAC,MAAI;AAClC,cAAQ,EAAE,MAAI;AAAA,QACb,KAAK;AACL,eAAK,OAAO,EAAE,KAAK,OAAO;AACzB;AAAA,QACD,KAAK;AACL,eAAK,MAAM,EAAE,IAAI;AAChB;AAAA,MACF;AAAA,KACA;AAEDA,kBAAG,MAAC,IAAI,uBAAsB,CAAC,EAAC,IAAG,MAAK,MAAI;AAC3C,WAAK,KAAK,QAAQ,UAAM;AACvB,YAAG,KAAK,OAAO,IAAI;AAClB,eAAK,gBAAgB;AAAA,QACtB;AAAA,OACA;AAAA,KACD;AAAA,EACD;AAAA,EACD,WAAW;AACVA,kBAAAA,MAAI,KAAK,uBAAsB,CAAC,MAAI;AAAA,IAAA,CAAE;AACtCA,kBAAAA,MAAI,KAAK,uBAAsB,CAAC,MAAI;AAAA,IAAA,CAAE;AAAA,EACtC;AAAA,EACD,2BAA2B;AAC1BA,kBAAAA,MAAI,UAAU;AAAA,MACb,SAAQ;AAAA,MACR,SAAS,CAAC,QAAQ;AACjB,YAAG,IAAI,SAAQ;AACdA,wBAAG,MAAC,kBAAkB,SAAS;AAC/B,eAAK,OAAO,CAAC;AAAA,QACd;AAAA,MACD;AAAA,KACA;AAAA,EACD;AAAA,EACD,SAAS;AAAA;AAAA,IAER,OAAO,SAAQ;AAEd,WAAK,KAAK,QAAQ,CAAC,SAAO;AACzB,YAAG,KAAK,YAAY,SAAQ;AAC3B,eAAK,WAAW;AAAA,QACjB;AAAA,OACA;AACDA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAM;AAAA,QACN,MAAK;AAAA,OACL;AAAA,IACD;AAAA;AAAA,IAED,MAAM,GAAE;AACP,WAAK,KAAK,QAAQ,UAAM;AACvB,YAAG,KAAK,OAAO,EAAE,IAAG;AACnB,cAAI,KAAK,MAAM,SAAS,IAAG;AAC1B,iBAAK,MAAM,EAAE,OAAK,QAAQ;AAAA,UAC1B,WACQ,KAAK,MAAM,SAAS,WAAW,EAAE,SAAS,YAAW;AAC7D,iBAAK,MAAM;AACX,iBAAK,MAAM;AAAA,UACZ,WACQ,KAAK,MAAM,SAAS,cAAc,EAAE,SAAS,SAAQ;AAC5D,iBAAK,MAAM;AACX,iBAAK,MAAM;AAAA,UACZ;AACA,eAAK,MAAM,OAAO,EAAE;AAAA,QACrB;AAAA,OACA;AACD,UAAI,MAAM,EAAE,SAAS,UAAU,MAAI;AACnCA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAM,MAAI;AAAA,QACV,MAAK;AAAA,MACN,CAAC;AAAA,IACD;AAAA,EACF;AACD;;;;;;;;;;;;;;;;;;;;;;ACnGD,GAAG,WAAW,eAAe;"}