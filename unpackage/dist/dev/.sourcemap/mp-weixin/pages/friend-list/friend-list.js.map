{"version":3,"file":"friend-list.js","sources":["pages/friend-list/friend-list.vue","../../AppGallery/HBuilderX.4.75.2025070414-alpha/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZnJpZW5kLWxpc3QvZnJpZW5kLWxpc3QudnVl"],"sourcesContent":["<template>\n\t<view>\r\n\t\t<!-- #ifdef MP -->\r\n\t\t<uni-nav-bar :shadow=\"false\" :border=\"false\" @click-right=\"goBack\">\r\n\t\t\t<!-- 中间搜索框 -->\r\n\t\t\t<view class=\"flex justify-center align-center rounded text-muted bg-light flex-1 mt-1\" style=\"margin-left: -46upx;height: 60upx;\" @tap=\"openSearch\">\r\n\t\t\t\t<view class=\"iconfont icon-sousuo mr-1\"></view>搜索帖子\r\n\t\t\t</view>\r\n\t\t\t<!-- 右边图标 -->\r\n\t\t\t<block slot=\"right\">\r\n\t\t\t\t<view class=\"text-dark font\">取消</view>\r\n\t\t\t</block>\r\n\t\t</uni-nav-bar>\r\n\t\t<!-- #endif -->\n\t\t<!-- tab -->\r\n\t\t<view class=\"flex align-center py-2\" style=\"height: 100rpx;\">\r\n\t\t\t<view class=\"flex-1 flex align-center justify-center\" \r\n\t\t\tv-for=\"(item,index) in tabBars\" :key=\"index\" \r\n\t\t\t:class=\"index === tabIndex ? 'font-lg font-weight-bold color-global': 'font-md'\"\r\n\t\t\t@click=\"changeTab(index)\">{{item.name}} <text v-if=\"item.num > 0\" class=\"ml-2\">{{item.num |formatNum}}</text></view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 滑动列表 -->\r\n\t\t<swiper :duration=\"150\" :current=\"tabIndex\" @change=\"onChangeTab\" :style=\"'height:'+scrollH+'px;'\">\r\n\t\t\t<swiper-item v-for=\"(item,index) in newList\" :key=\"index\">\r\n\t\t\t\t<scroll-view scroll-y=\"true\" :style=\"'height:'+scrollH+'px;'\" @scrolltolower=\"loadmore(index)\">\r\n\t\t\t\t\t<template v-if=\"item.list.length > 0\">\r\n\t\t\t\t\t<!-- 列表 -->\r\n\t\t\t\t\t<block v-for=\"(item2,index2) in item.list\" :key=\"index2\">\r\n\t\t\t\t\t\t<!-- 列表样式 -->\r\n\t\t\t\t\t\t<user-list :item=\"item2\" :index=\"index\"></user-list>\r\n\t\t\t\t\t</block>\r\n\t\t\t\t\t<!-- 上拉加载 -->\r\n\t\t\t\t\t<load-more v-if=\"item.list.length > 10\" :loadmore=\"item.loadmore\"></load-more>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t\t<!-- 没有数据 -->\r\n\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t<no-thing></no-thing>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</swiper-item>\r\n\t\t</swiper>\n\t</view>\n</template>\n\n<script>\r\n\timport uniNavBar from '@/components/uni-uni/uni-nav-bar/uni-nav-bar.vue';\r\n\timport loadMore from '@/components/common/load-more.vue';\r\n\timport noThing from '@/components/common/no-thing.vue';\r\n\timport userList from '@/components/user-list/user-list.vue';\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tloadMore,\r\n\t\t\tnoThing,\r\n\t\t\tuserList,\r\n\t\t\tuniNavBar\r\n\t\t},\n\t\tdata() {\n\t\t\treturn {\r\n\t\t\t\t//列表高度\r\n\t\t\t\tscrollH : 600,\r\n\t\t\t\ttabIndex:0,\n\t\t\t\ttabBars:[{\r\n\t\t\t\t\tname:\"互关\",\r\n\t\t\t\t\tnum:0,\r\n\t\t\t\t\tkey:\"friends\"\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:\"关注\",\r\n\t\t\t\t\tnum:0,\r\n\t\t\t\t\tkey:\"follows\"\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:\"粉丝\",\r\n\t\t\t\t\tnum:0,\r\n\t\t\t\t\tkey:\"fens\"\r\n\t\t\t\t}],\r\n\t\t\t\tnewList:[]\n\t\t\t}\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tuni.getSystemInfo({\r\n\t\t\t\tsuccess:res=>{\r\n\t\t\t\t\tthis.scrollH = res.windowHeight - uni.upx2px(100)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t// 根据选项生成列表\r\n\t\t\tthis.getData()\r\n\t\t},\r\n\t\t// 监听点击输入框事件\r\n\t\tonNavigationBarSearchInputClicked() {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: '/pages/search/search?type=user',\t\t\t\t\r\n\t\t\t});\r\n\t\t},\r\n\t\tonNavigationBarButtonTap() {\r\n\t\t\tuni.navigateBack({\r\n\t\t\t\tdelta:1\r\n\t\t\t})\r\n\t\t},\r\n\t\tfilters:{\r\n\t\t\tformatNum(value) {\r\n\t\t\t\treturn value > 99 ? '99+' : value;\r\n\t\t\t}\r\n\t\t},\n\t\tmethods: {\r\n\t\t\t// 获取用户相关统计数据\r\n\t\t\tgetCounts(){\r\n\t\t\t\tthis.$H.get('/user/getcounts/'+this.user.id,{},{\r\n\t\t\t\t\ttoken:true,\r\n\t\t\t\t\tnotoast:true\r\n\t\t\t\t}).then(res=>{\r\n\t\t\t\t\tthis.tabBars[0].num = res.data.data.friend_count\r\n\t\t\t\t\tthis.tabBars[1].num = res.data.data.withfollow_count\r\n\t\t\t\t\tthis.tabBars[2].num = res.data.data.withfen_count\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//获取数据\r\n\t\t\tgetData() {\r\n\t\t\t\tvar arr = []\r\n\t\t\t\tfor (let i = 0; i < this.tabBars.length; i++) {\r\n\t\t\t\t\t//生成列表模板\r\n\t\t\t\t\tlet obj = {\r\n\t\t\t\t\t\t//1.上拉加载更多 2.加载中 3...没有更多了\r\n\t\t\t\t\t\tloadmore:\"上拉加载更多\",\r\n\t\t\t\t\t\tlist:[],\r\n\t\t\t\t\t\tpage:1,\r\n\t\t\t\t\t\tfirstLoad:false\r\n\t\t\t\t\t}\r\n\t\t\t\t\tarr.push(obj)\r\n\t\t\t\t}\r\n\t\t\t\tthis.newList = arr\r\n\t\t\t\tthis.getList()\r\n\t\t\t},\r\n\t\t\t// 获取指定分类下的列表数据\r\n\t\t\tgetList(){\r\n\t\t\t\tlet index = this.tabIndex\r\n\t\t\t\tlet id = this.tabBars[index].id\r\n\t\t\t\tlet page = this.newList[index].page\r\n\t\t\t\tlet isrefresh = page === 1\r\n\t\t\t\tthis.$H.get('/'+this.tabBars[index].key+'/'+page,{},{\r\n\t\t\t\t\ttoken:true,\r\n\t\t\t\t\tnoCheck:true\r\n\t\t\t\t}).then(res2=>{\r\n\t\t\t\t\tlet list = res2.data.data.list.map(v=>{\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tid:v.id,\r\n\t\t\t\t\t\t\theadshot:v.userpic,\r\n\t\t\t\t\t\t\tusername:v.username,\r\n\t\t\t\t\t\t\tgender:v.userinfo.sex,\r\n\t\t\t\t\t\t\tage:v.userinfo.age,\r\n\t\t\t\t\t\t\tisFollow:index !== 2\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.newList[index].list = isrefresh ? list : [...this.newList[index].list,\r\n\t\t\t\t\t...list],\r\n\t\t\t\t\tthis.newList[index].loadmore = list.length < 10 ?'没有更多了' : '上拉加载更多'\r\n\t\t\t\t\tif (isrefresh) {\r\n\t\t\t\t\t\tthis.newList[index].firstLoad = true\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(err=>{\r\n\t\t\t\t\tif (!isrefresh) {\r\n\t\t\t\t\t\tthis.newList[index].page--\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\n\t\t\t// tab切换\r\n\t\t\tchangeTab(index){\r\n\t\t\t\tthis.tabIndex = index\r\n\t\t\t},\r\n\t\t\t//监听滑动\r\n\t\t\tonChangeTab(e) {\r\n\t\t\t\tthis.changeTab(e.detail.current)\r\n\t\t\t\tif(!this.newList[e.detail.current].firstLoad) {\r\n\t\t\t\t\tthis.getList()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//上拉加载更多\r\n\t\t\tloadmore(index) {\r\n\t\t\t\t// 拿到当前列表\r\n\t\t\t\tlet item = this.newList[index]\r\n\t\t\t\t// 判断是否处于可加载状态\r\n\t\t\t\tif(item.loadmore !== '上拉加载更多') return;\r\n\t\t\t\t//修改当前列表加载状态\r\n\t\t\t\titem.loadmore = '加载中...'\r\n\t\t\t\t//数据请求\r\n\t\t\t\titem.page++\r\n\t\t\t\tthis.getList()\r\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\n</style>\n","import MiniProgramPage from 'F:/project/社区交友/pages/friend-list/friend-list.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}